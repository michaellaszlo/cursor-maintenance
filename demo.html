<!DOCTYPE html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css"
 href="https://fonts.googleapis.com/css?family=Roboto">
<style>
* {
  margin: 0;
  padding: 0;
}
body {
}
#wrapper {
  text-align: center;
}
#numberInput {
  margin-top: 150px;
  width: 200px;
  text-align: center;
  font-family: Roboto, sans-serif;
  font-size: 24px;
  padding: 5px 10px;
  border: 2px solid #888;
  border-radius: 5px;
  outline: none;
}
</style>
<script src="maintain.cursor.js"></script>
<script src="format.number.js"></script>
<script>

// Format a non-negative integer with no zero padding.
function format(s) {
  // Delete non-digits.
  s = s.replace(/\D/g, '');
  // Delete zero padding.
  s = s.replace(/^0+/, '0');
  if (s.charAt(0) == '0' && s.length > 1) {
    s = s.substring(1);
  }
  // Insert commas to separate groups of three digits.
  s = FormatNumber.groupDigits(s);
  return s;
}

function updateInput() {
  var oldPosition,
      newPosition;
      original = this.value,
      formatted = format(this.value);
  if (formatted === original) {
    return;
  }
  oldPosition = this.selectionStart;
  newPosition = MaintainCursor.findNewPosition(
      original, oldPosition, formatted);
  this.value = formatted;
  this.setSelectionRange(newPosition, newPosition);
}

window.onload = function () {
  var numberInput = document.getElementById('numberInput'),
      handler = updateInput.bind(numberInput);
  [ 'change', 'keydown', 'click' ].forEach(function (eventName) {
    numberInput['on' + eventName] = function () {
      // Set zero timeout to add our handler to the end of the event queue.
      setTimeout(handler, 0);
    };
  });
  numberInput.focus();
};
</script>
</head>
<body>
<div id="wrapper">

<input id="numberInput">

</div>
</body>
</html>
