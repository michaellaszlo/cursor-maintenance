<!DOCTYPE html>
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet"
 href="https://fonts.googleapis.com/css?family=Roboto|Droid+Sans+Mono">
<link rel="stylesheet" href="../note_expander/note_expander.css">
<link rel="stylesheet" href="demo.css">

<script src="../cursor_maintainer.js"></script>
<script src="../note_expander/note_expander.js"></script>
<script src="demo.js"></script>

<title> Cursor maintenance demos </title>

</head>
<body>

<div id="wrapper">


<h1> Cursor-maintenance demos </h1>

<div class="notes">

<p> This page demonstrates two approaches to maintaining cursor position
in a text input field that formats its contents in real time. The goal
is to position the cursor in newly formatted text so as to minimize user
surprise.

<p> The problem of cursor maintenance is discussed in a <a
href="">detailed article</a>.

<p> Fully documented source code is available in a <a href="">source
repository</a>.

</div>


<h2> Meta approach </h2>

<div class="notes">

<p> In the meta approach, we reimplement a text formatting operation by
applying elementary operations to a text-with-cursor object. The object
moves the cursor in a predictable manner for each elementary operation.

<p> Below we demonstrate the meta approach with two formatting operations,
<em>commatize</em> and <em>trimify</em>.

<p> Commatize is defined for text consisting of digits and commas. Input
strings containing other characters are rejected by a validation
function that runs before the formatting operation. Commatize displays
a non-negative integer with commas separating groups of three digits.

<p> Trimify is applicable to any text, so the input is not validated
before formatting. Trimify removes whitespace from the beginning of the
text, then condenses all other whitespace sequences to one space each.

</div>


<h3> commatize </h3>

<input id="commatizeInput" spellcheck="false">


<h3> trimify </h3>

<textarea id="trimifyInput" spellcheck="false" class="text"></textarea>


<h2> Retrospective approach </h2>

<div class="notes">

<p> In the retrospective approach, we calculate a new cursor position
by comparing the new text to the old text and cursor. We only consider
the current instance of text formatting. Thus, any formatting operation
can be used without modification.

<p> You can define a formatting operation to be used in the following
input field by inserting a JavaScript function into the editable code
box below. Any function that takes a string argument and returns a string
is formally valid as a formatting operation.

<p> The retrospective formula used here computes the ratios of character
frequencies to the left and right of the cursor in the old text, then
aims for similar ratios in the new text with a least-squares fit.

</div>


<h3> input field </h3>

<textarea id="flexibleInput" spellcheck="false" class="text"></textarea>


<h3> formatting operation </h3>

<textarea id="flexibleCode" spellcheck="false" class="code"></textarea>


</div><!--end wrapper -->
</body>
</html>
